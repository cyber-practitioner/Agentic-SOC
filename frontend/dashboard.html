<!DOCTYPE html>
<html>
<head>
    <title>Alert Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-900 text-white p-6" x-data="alertDashboard()">
    
    <h1 class="text-2xl font-bold mb-6">ðŸ“¡ Incoming Alerts</h1>

    <!-- Alert List -->
    <div class="space-y-4">
        <template x-for="alert in alerts" :key="alert.id">
            <div class="bg-gray-800 border-l-4 p-4 rounded" 
                 :class="alert.severity === 'critical' ? 'border-red-500' : 
                        alert.severity === 'warning' ? 'border-yellow-500' : 'border-blue-500'">
                
                <!-- Alert Title -->
                <div class="flex justify-between items-start mb-2">
                    <h3 class="font-semibold text-lg" x-text="alert.title || 'Security Alert'"></h3>
                    <span class="text-xs text-gray-400" x-text="new Date(alert.timestamp).toLocaleString()"></span>
                </div>
                
                <!-- Alert Summary -->
                <div class="text-gray-300 mb-2" x-text="alert.summary || alert.message || 'No summary available'"></div>
                
                <!-- Alert Details -->
                <div class="flex space-x-4 text-sm text-gray-400">
                    <span>Severity: <span :class="alert.severity === 'critical' ? 'text-red-400' : 
                                                alert.severity === 'warning' ? 'text-yellow-400' : 'text-blue-400'" 
                          x-text="alert.severity?.toUpperCase()"></span></span>
                    <span x-show="alert.source">Source: <span class="text-cyan-300" x-text="alert.source"></span></span>
                </div>
            </div>
        </template>
        
        <!-- No Alerts Message -->
        <div x-show="alerts.length === 0" class="text-center py-8 text-gray-500">
            <div class="text-4xl mb-2">ðŸ“­</div>
            <div>No alerts received yet</div>
        </div>
    </div>

    <script>
        function alertDashboard() {
            return {
                alerts: [],
                
                init() {
                    this.loadAlerts();
                    setInterval(() => this.loadAlerts(), 2000); // Check every 2 seconds
                },
                
                async loadAlerts() {
                    try {
                        const response = await fetch('/alerts');
                        if (response.ok) {
                            const data = await response.json();
                            this.alerts = data.alerts || [];
                        }
                    } catch (error) {
                        console.log('Loading alerts...', error);
                    }
                }
            }
        }
    </script>
</body>
</html>